# 脑电数据分析项目文档

## 项目概述

本项目是一套完整的脑电图(EEG)数据分析工具包，包含了从原始数据处理到深度学习模型训练的全流程解决方案。主要用于阿尔茨海默病(AD)、健康对照(HC)和额颞叶痴呆(FTD)的三分类诊断研究。

## 文件结构说明

### 1. 数据预处理模块

#### `公开数据集colula PLV矩阵.py`
- **功能**: 基于Copula理论的功能连接分析
- **主要特点**:
  - 实现多种Copula函数（高斯、学生t、Gumbel、Frank、Clayton）
  - 计算功能连接矩阵和图论指标
  - 包含稳定性检验和拟合优度检验
  - 提取标准差、中位数、聚类系数等特征

#### `公开数据集PLV特征2.py`
- **功能**: 相位锁定值(PLV)和皮尔逊相关分析
- **主要特点**:
  - 计算PLV和皮尔逊相关系数矩阵
  - 实现部分相关分析方法（Poli等，2014）
  - 提取图论指标（小世界网络指数、图指数复杂度）
  - 生成标准化的特征矩阵

#### `公开数据集Robustness_Fit_Copula_PLV矩阵.py`
- **功能**: 增强版Copula分析，重点在于鲁棒性验证
- **主要特点**:
  - Copula连接稳定性检验（不同样本量下的变异系数分析）
  - Copula拟合优度检验（Kolmogorov-Smirnov检验）
  - 更完善的异常处理机制
  - 详细的稳定性报告生成

#### `公开数据集格兰杰因果PLV矩阵.py`
- **功能**: 格兰杰因果分析和PLV计算
- **主要特点**:
  - 基于AIC准则的最优滞后阶数选择
  - 格兰杰因果F值矩阵计算
  - 改进的异常处理机制
  - 批量处理88个被试数据

### 2. 可视化分析模块

#### `公开数据集可视化分析.py`
- **功能**: 多模态脑电功能连接可视化
- **主要特点**:
  - 生成专业的脑电图功能连接分析图
  - 支持四种分析方法的对比可视化（格兰杰因果、Copula、PLV、皮尔逊）
  - 符合神经科学期刊标准的图表样式
  - PDF格式高质量输出

### 3. 深度学习模型模块

#### `图网络注意力改良（动态阈值2分类）.py`
- **功能**: 基于GNN的二分类诊断模型
- **主要特点**:
  - 动态阈值自适应调整机制
  - 结合GCN和GAT的混合架构
  - 多损失函数联合优化（分类、重构、对比损失）
  - 消融实验对比固定阈值方法

#### `图网络注意力改良（动态阈值3分类）.py`
- **功能**: 基于GNN的三分类诊断模型
- **主要特点**:
  - 支持AD、HC、FTD三分类任务
  - 增强的动态阈值训练策略
  - 混淆矩阵可视化功能
  - 更复杂的多类别评估指标

## 技术特色

### 核心创新点
1. **动态阈值机制**: 根据训练过程自适应调整图构建阈值
2. **多模态融合**: 整合Copula、PLV、格兰杰因果等多种分析方法
3. **鲁棒性验证**: 系统性的稳定性检验和拟合优度分析
4. **可解释性增强**: 通过注意力机制和可视化提升模型透明度

### 算法优势
- **自适应学习**: 动态阈值能够根据数据特征自动优化
- **多尺度分析**: 从时域到频域的全面特征提取
- **鲁棒性强**: 通过稳定性检验确保结果可靠性
- **临床适用**: 面向实际医疗诊断场景设计

## 使用流程

### 数据准备
1. 确保EEG数据按照BIDS格式组织
2. 配置正确的数据路径（main_dir变量）
3. 准备电极位置信息

### 分析流程
```bash
# 1. 特征提取
python 公开数据集colula\ PLV矩阵.py
python 公开数据集PLV特征2.py
python 公开数据集格兰杰因果PLV矩阵.py

# 2. 可视化分析
python 公开数据集可视化分析.py

# 3. 模型训练
python 图网络注意力改良（动态阈值2分类）.py  # 二分类
python 图网络注意力改良（动态阈值3分类）.py  # 三分类
```

## 环境依赖

### 核心库
- Python 3.7+
- PyTorch 1.8+
- PyTorch Geometric
- MNE-Python
- NumPy, SciPy
- Scikit-learn
- NetworkX
- Matplotlib, Seaborn

### 安装建议
```bash
pip install torch torchvision torchaudio
pip install torch-geometric
pip install mne numpy scipy scikit-learn networkx
pip install matplotlib seaborn
```

## 输出结果

### 特征文件
- 各种功能连接矩阵（.txt格式）
- 统计特征向量（标准差、中位数等）
- 图论指标（聚类系数、效率等）

### 可视化文件
- 脑电功能连接分析图（PDF格式）
- 混淆矩阵图
- 训练过程监控图

### 模型性能
- 交叉验证准确率
- 多类别评估指标（灵敏度、特异性、精确度）
- 消融实验对比结果

## 注意事项

1. **数据隐私**: 确保遵循相关伦理审查要求
2. **计算资源**: 建议使用GPU加速深度学习训练
3. **参数调优**: 根据具体数据集调整超参数
4. **结果验证**: 建议进行独立测试集验证

## 开发者信息

本项目由Liu Yanzhi开发，用于阿兹海默症患者与正常人分类的研究。
如有问题请联系：954674048@qq.com

---
*最后更新：2026年02月06日*
